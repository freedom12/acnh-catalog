// ============================================
// 卡片组件样式 - Card Component
// ============================================

@use 'sass:map';
@use '../abstracts' as *;

// --------------------------------------------
// 卡片基础样式
// --------------------------------------------

.card {
  position: relative;
  @include flex-column-center;
  @include card-base($radius-2xl, $spacing-md);
  text-align: center;
  @include hover-lift;

  // 左上角 Checkmark 定位
  &-checkmark {
    position: absolute;
    top: $spacing-sm;
    left: $spacing-sm;
    z-index: $z-index-dropdown;
  }
}

// --------------------------------------------
// 卡片变体
// --------------------------------------------

.card--variant-light {
  background: $color-white;
  border: 5px solid $color-white;

  .card-image-wrapper {
    background: linear-gradient(135deg, var(--base-color) 0%, var(--main-color) 500%);
  }
}

.card--variant-dark {
  background: var(--base-color);
  border: 5px solid var(--main-color);

  .card-image-wrapper {
    background: $color-bg-light;
  }
}

// --------------------------------------------
// 卡片颜色主题 - 使用循环生成
// --------------------------------------------

@each $name, $colors in $theme-colors {
  .card--#{$name} {
    --main-color: #{map.get($colors, 'main')};
    --base-color: #{map.get($colors, 'base')};
    --shadow-color: #{map.get($colors, 'shadow')};
  }
}

// --------------------------------------------
// 闪光效果
// --------------------------------------------

.card--shiny {
  @include shine-effect;
}

// --------------------------------------------
// DIY 背景
// --------------------------------------------

.recipe-bg {
  background-image:
    linear-gradient(rgba($color-white, 0.7), rgba($color-white, 0.5)),
    url('@/assets/img/diy_bg.png');
  background-size: 100%;
  background-position: top;
  background-repeat: repeat;
}

// --------------------------------------------
// 图片容器
// --------------------------------------------

.card-image-container {
  position: relative;
  display: inline-block;
  margin: 0 auto $spacing-sm;

  &.large-image {
    width: 100%;
  }

  &:hover .card-corner-icon {
    opacity: 0;
    visibility: hidden;
  }
}

.card-image-wrapper {
  position: relative;
  @include flex-center;
  @include circle($card-image-size);
  overflow: hidden;
  cursor: pointer;
  @include hover-scale;

  &.rounded {
    border-radius: $radius-2xl;
  }

  &.square {
    border-radius: 0;
  }

  &.large-image {
    width: 100%;
    aspect-ratio: 1 / 1;
    height: auto;
  }
}

.card-image {
  width: 85%;
  height: 85%;
  object-fit: contain;

  &.large-image {
    width: 75%;
    height: 75%;
  }
}

// --------------------------------------------
// 图片导航
// --------------------------------------------

.image-nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: $z-index-dropdown;
  @include flex-center;
  @include circle($icon-size-md);
  background: rgba($color-black, 0.6);
  color: $color-white;
  font-size: $font-size-sm;
  font-weight: $font-weight-bold;
  @include transition;

  &:hover {
    background: rgba($color-black, 0.8);
    transform: translateY(-50%) scale(1.1);
  }

  &:active {
    transform: translateY(-50%) scale(0.95);
  }

  &.image-nav-prev {
    left: -32px;
  }

  &.image-nav-next {
    right: -32px;
  }
}

// --------------------------------------------
// 图片指示器
// --------------------------------------------

.image-indicators {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: $z-index-dropdown;
  @include flex-row(4px);
}

.indicator {
  @include circle(6px);
  background: rgba($color-black, 0.5);
  cursor: pointer;
  @include transition;

  &:hover {
    background: rgba($color-black, 0.7);
    transform: scale(1.3);
  }

  &.active {
    background: rgba($color-black, 0.9);
    transform: scale(1.2);
  }
}

// --------------------------------------------
// 卡片内容
// --------------------------------------------

.card-info {
  width: 100%;
  min-height: 60px;
}

.card-name {
  margin: 0 0 $spacing-sm;
  font-size: $font-size-lg;
  font-weight: $font-weight-semibold;
  line-height: $line-height-tight;
  text-align: center;
  color: var(--main-color);

  &:last-child {
    margin-bottom: 0;
  }
}

.card-corner-icon {
  position: absolute;
  bottom: 5px;
  right: 5px;
  width: $icon-size-xl;
  height: $icon-size-xl;
  border-radius: $radius-full;
  background: rgba($color-white, 0.8);
  padding: 2px;
  box-shadow: $shadow-sm;
  opacity: 1;
  visibility: visible;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

// --------------------------------------------
// 卡片详情容器
// --------------------------------------------

.card-details {
  @include flex-column(6px);
  width: 100%;
}

// --------------------------------------------
// 部件复选标记
// --------------------------------------------

.parts-checkmarks {
  @include flex-center;
  flex-wrap: wrap;
  gap: 6px;
  margin: $spacing-sm 0;
}
